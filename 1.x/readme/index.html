<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>ce-provision</title>
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  
  <link rel="stylesheet" href="https://codeenigma.github.io/ce-provision-docs/1.x/css/main.min.9c98165d1dd1f18e44902c88197986b800a6f81dad436c40e50a55817cd0f131.css">
</head><body class="doc"><header><a href="https://codeenigma.github.io/ce-provision-docs/1.x/home">ce-provision</a></header><article>
        <h1 id="ce-provision">ce-provision</h1>
<p>A set of Ansible roles and wrapper scripts to configure remote (Debian) machines.</p>
<h2 id="overview">Overview</h2>
<p>The &ldquo;stack&rdquo; from this repo is to be installed on a &ldquo;controller&rdquo; server/runner, to be used in conjonction with a CI/CD tool (Jenkins, Gitlab, Travis, &hellip;).
It allows the configuration for a given service to be easily customizable at will, and to be stored in a git repository.
When triggered from a deployment tool, the stack will clone the codebase and &ldquo;play&rdquo; a given deploy playbook from there.</p>
<!-- raw HTML omitted -->
<h2 id="installinstallreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/install/README.md" >Install</a>
</h2>
<p>You can install either:</p>
<ul>
<li>through 
<a href="https://github.com/codeenigma/ce-provision"  target="_blank" rel="noopener">ce-provision</a>
</li>
<li>manually by running a local playbook</li>
<li>with Docker (soon)</li>
</ul>
<h2 id="usagescriptsreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/scripts/README.md" >Usage</a>
</h2>
<p>While you can re-use/fork roles or call playbooks directly from your deployment tool, it is recommended to use the provided wrapper script, as it will take care of setting up the needed environments variables.</p>
<h2 id="rolesrolesreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/README.md" >Roles</a>
</h2>
<p>Ansible roles and group of roles that constitute the deploy stack.</p>
<h3 id="ansiblerolesansiblereadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ansible/README.md" >Ansible</a>
</h3>
<h3 id="extra-packagesrolesapt_extra_packagesreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/apt_extra_packages/README.md" >Extra packages</a>
</h3>
<p>Provides a wrapper for installing packages through apt.</p>
<h3 id="aws-tools-rolesrolesawsreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/README.md" >AWS tools roles</a>
</h3>
<h3 id="ce-deployrolesce_deployreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_deploy/README.md" >ce-deploy</a>
</h3>
<p>Installs Code Enigma&rsquo;s deploy stack on a server.</p>
<h3 id="extra-packagesrolesce_devreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_dev/README.md" >Extra packages</a>
</h3>
<p>Provides a wrapper for installing packages through apt.</p>
<h3 id="ce-provisionrolesce_provisionreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_provision/README.md" >ce-provision</a>
</h3>
<p>Installs Code Enigma&rsquo;s infrastructure management stack on a server.</p>
<h3 id="clamav-clamscanrolesclamav_clamscanreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/clamav_clamscan/README.md" >ClamAV Clamscan</a>
</h3>
<h3 id="clamav-daemonrolesclamav_daemonreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/clamav_daemon/README.md" >ClamAV Daemon</a>
</h3>
<h3 id="ufw-firewallrolesfirewallreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/firewall/README.md" >UFW Firewall</a>
</h3>
<h3 id="gitlabrolesgitlabreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gitlab/README.md" >Gitlab</a>
</h3>
<h3 id="gitlab-runnerrolesgitlab_runnerreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gitlab_runner/README.md" >Gitlab Runner</a>
</h3>
<p>Install the Gitlab Runner binary from .deb package.</p>
<h3 id="gpg-keyrolesgpg_keyreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gpg_key/README.md" >GPG Key</a>
</h3>
<p>Generates a passwordless GPG key for a given user or users.</p>
<h3 id="ha-proxyroleshaproxyreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/haproxy/README.md" >HA Proxy</a>
</h3>
<h3 id="managed-etchostsroleshostsreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/hosts/README.md" >Managed /etc/hosts</a>
</h3>
<p>Forked from <a href="https://github.com/bertvv/ansible-role-hosts">https://github.com/bertvv/ansible-role-hosts</a></p>
<h3 id="jenkinsrolesjenkinsreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/jenkins/README.md" >Jenkins</a>
</h3>
<h3 id="meta-roles-that-group-individual-roles-togetherrolesmetareadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/meta/README.md" >&ldquo;Meta&rdquo; roles that group individual roles together.</a>
</h3>
<h3 id="mariadb-clientrolesmysql_clientreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/mysql_client/README.md" >MariaDB Client</a>
</h3>
<h3 id="opcacherolesopcachereadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/opcache/README.md" >opcache</a>
</h3>
<p>Installs and configures gordalina&rsquo;s cache tool: <a href="https://github.com/gordalina/cachetool">https://github.com/gordalina/cachetool</a></p>
<h3 id="defaults-file-for-ossecrolesossecreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ossec/README.md" >defaults file for ossec</a>
</h3>
<p>ossec:
client: true								# if client is true installs the ossec agent, if false installs the server
serverip: &ldquo;123.123.123.123&rdquo;						# server IP in case of client false</p>
<p>global:
email_notification: &ldquo;yes&rdquo;
email_to: &ldquo;<a href="mailto:admin@example.com">admin@example.com</a>&rdquo;
smtp_server: &ldquo;mail.google.com&rdquo;
email_from: &ldquo;<a href="mailto:admin@example.com">admin@example.com</a>&rdquo;
white_list:</p>
<ul>
<li>&ldquo;8.8.8.8&rdquo;</li>
<li>&ldquo;4.4.4.4&rdquo;
alerts:
log_alert_level: 1
email_alert_level: 7</li>
</ul>
<p>email_alerts:
email_to: &ldquo;<a href="mailto:admin@example.com">admin@example.com</a>&rdquo;
level: 14</p>
<p>syscheck:
frequency: 79200
directories:</p>
<ul>
<li>/etc</li>
<li>/usr/bin</li>
<li>/usr/sbin</li>
<li>/bin</li>
<li>/sbin
ignore:</li>
<li>/etc/mtab</li>
<li>/etc/mnttab</li>
<li>/etc/hosts.deny</li>
<li>/etc/mail/statistics</li>
<li>/etc/random-seed</li>
<li>/etc/adjtime</li>
<li>/etc/httpd/logs</li>
<li>/etc/utmpx</li>
<li>/etc/wtmpx</li>
<li>/etc/cups/certs</li>
<li>/etc/dumpdates</li>
<li>/etc/svc/volatile</li>
<li>/etc/puppet</li>
<li>/etc/resolv.conf</li>
<li>/etc/hybserv</li>
</ul>
<p>rootcheck:
disabled: &ldquo;no&rdquo;
rootkit_files:</p>
<ul>
<li>/var/ossec/etc/shared/rootkit_files.txt
rootkit_trojans:</li>
<li>/var/ossec/etc/shared/rootkit_trojans.txt
system_audit:</li>
<li>/var/ossec/etc/shared/system_audit_rcl.txt</li>
<li>/var/ossec/etc/shared/cis_debian_linux_rcl.txt</li>
<li>/var/ossec/etc/shared/cis_rhel_linux_rcl.txt</li>
<li>/var/ossec/etc/shared/cis_rhel5_linux_rcl.txt</li>
</ul>
<p>command:</p>
<ul>
<li>{ name: &lsquo;firewall-drop&rsquo;, executable: &lsquo;firewall-drop.sh&rsquo;, expect: &lsquo;srcip&rsquo;, timeout_allowed: &lsquo;yes&rsquo; }</li>
</ul>
<p>activeresponse:</p>
<ul>
<li>{ disabled: &lsquo;no&rsquo;, command: &lsquo;firewall-drop&rsquo;, location: &lsquo;all&rsquo;, rules_id: &lsquo;31151,5712,104130,101071,101132,101238,101251,103011&rsquo;, repeated_offenders: &lsquo;30,60,120&rsquo;, timeout: &lsquo;600&rsquo; }</li>
<li>{ disabled: &lsquo;no&rsquo;, command: &lsquo;firewall-drop&rsquo;, location: &lsquo;all&rsquo;, rules_id: &lsquo;100205&rsquo;, repeated_offenders: &lsquo;30,60,120&rsquo;, timeout: &lsquo;3600&rsquo; }</li>
</ul>
<p>remote:
connection:</p>
<ul>
<li>syslog</li>
<li>secure</li>
</ul>
<p>localfile:</p>
<ul>
<li>{ log_format: &lsquo;syslog&rsquo;, location: &lsquo;/var/log/messages&rsquo; }</li>
<li>{ log_format: &lsquo;syslog&rsquo;, location: &lsquo;/var/log/auth.log&rsquo; }</li>
<li>{ log_format: &lsquo;syslog&rsquo;, location: &lsquo;/var/log/syslog&rsquo; }</li>
<li>{ log_format: &lsquo;syslog&rsquo;, location: &lsquo;/var/log/mail.info&rsquo; }</li>
<li>{ log_format: &lsquo;syslog&rsquo;, location: &lsquo;/var/log/dpkg.log&rsquo; }</li>
</ul>
<p>rules:								# all *_rules.xml files will be copied over</p>
<ul>
<li>rules_config.xml							# for customer rules you can create customerX_rules.xml</li>
<li>pam_rules.xml</li>
<li>sshd_rules.xml</li>
<li>telnetd_rules.xml</li>
<li>syslog_rules.xml</li>
<li>arpwatch_rules.xml</li>
<li>symantec-av_rules.xml</li>
<li>symantec-ws_rules.xml</li>
<li>pix_rules.xml</li>
<li>named_rules.xml</li>
<li>smbd_rules.xml</li>
<li>vsftpd_rules.xml</li>
<li>proftpd_rules.xml</li>
<li>ms_ftpd_rules.xml</li>
<li>ftpd_rules.xml</li>
<li>hordeimp_rules.xml</li>
<li>roundcube_rules.xml</li>
<li>wordpress_rules.xml</li>
<li>cimserver_rules.xml</li>
<li>vpopmail_rules.xml</li>
<li>vmpop3d_rules.xml</li>
<li>courier_rules.xml</li>
<li>web_rules.xml</li>
<li>web_appsec_rules.xml</li>
<li>apache_rules.xml</li>
<li>nginx_rules.xml</li>
<li>php_rules.xml</li>
<li>mysql_rules.xml</li>
<li>postgresql_rules.xml</li>
<li>ids_rules.xml</li>
<li>squid_rules.xml</li>
<li>firewall_rules.xml</li>
<li>cisco-ios_rules.xml</li>
<li>netscreenfw_rules.xml</li>
<li>sonicwall_rules.xml</li>
<li>postfix_rules.xml</li>
<li>sendmail_rules.xml</li>
<li>imapd_rules.xml</li>
<li>mailscanner_rules.xml</li>
<li>dovecot_rules.xml</li>
<li>ms-exchange_rules.xml</li>
<li>racoon_rules.xml</li>
<li>vpn_concentrator_rules.xml</li>
<li>spamd_rules.xml</li>
<li>msauth_rules.xml</li>
<li>mcafee_av_rules.xml</li>
<li>trend-osce_rules.xml</li>
<li>ms-se_rules.xml</li>
<li>zeus_rules.xml</li>
<li>solaris_bsm_rules.xml</li>
<li>vmware_rules.xml</li>
<li>ms_dhcp_rules.xml</li>
<li>asterisk_rules.xml</li>
<li>ossec_rules.xml</li>
<li>attack_rules.xml</li>
<li>openbsd_rules.xml</li>
<li>clam_av_rules.xml</li>
<li>dropbear_rules.xml</li>
<li>local_rules.xml</li>
</ul>
<h2 id="license">License</h2>
<p>BSD</p>
<h2 id="author-information">Author Information</h2>
<p>An optional section for the role authors to include contact information, or a website (HTML is not allowed).</p>
<h3 id="sshdrolesssh_serverreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ssh_server/README.md" >SSHD</a>
</h3>
<h3 id="sslrolessslreadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ssl/README.md" >SSL</a>
</h3>
<p>Manages SSL certificates.</p>
<h2 id="contributecontributereadmemd">
<a href="https://codeenigma.github.io/ce-provision-docs/1.x/contribute/README.md" >Contribute</a>
</h2>
<!-- raw HTML omitted -->

    </article>
    <aside>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ce-provision">ce-provision</a>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#installinstallreadmemd"><a href="install/README.md">Install</a></a></li>
        <li><a href="#usagescriptsreadmemd"><a href="scripts/README.md">Usage</a></a></li>
        <li><a href="#rolesrolesreadmemd"><a href="roles/README.md">Roles</a></a>
          <ul>
            <li><a href="#ansiblerolesansiblereadmemd"><a href="roles/ansible/README.md">Ansible</a></a></li>
            <li><a href="#extra-packagesrolesapt_extra_packagesreadmemd"><a href="roles/apt_extra_packages/README.md">Extra packages</a></a></li>
            <li><a href="#aws-tools-rolesrolesawsreadmemd"><a href="roles/aws/README.md">AWS tools roles</a></a></li>
            <li><a href="#ce-deployrolesce_deployreadmemd"><a href="roles/ce_deploy/README.md">ce-deploy</a></a></li>
            <li><a href="#extra-packagesrolesce_devreadmemd"><a href="roles/ce_dev/README.md">Extra packages</a></a></li>
            <li><a href="#ce-provisionrolesce_provisionreadmemd"><a href="roles/ce_provision/README.md">ce-provision</a></a></li>
            <li><a href="#clamav-clamscanrolesclamav_clamscanreadmemd"><a href="roles/clamav_clamscan/README.md">ClamAV Clamscan</a></a></li>
            <li><a href="#clamav-daemonrolesclamav_daemonreadmemd"><a href="roles/clamav_daemon/README.md">ClamAV Daemon</a></a></li>
            <li><a href="#ufw-firewallrolesfirewallreadmemd"><a href="roles/firewall/README.md">UFW Firewall</a></a></li>
            <li><a href="#gitlabrolesgitlabreadmemd"><a href="roles/gitlab/README.md">Gitlab</a></a></li>
            <li><a href="#gitlab-runnerrolesgitlab_runnerreadmemd"><a href="roles/gitlab_runner/README.md">Gitlab Runner</a></a></li>
            <li><a href="#gpg-keyrolesgpg_keyreadmemd"><a href="roles/gpg_key/README.md">GPG Key</a></a></li>
            <li><a href="#ha-proxyroleshaproxyreadmemd"><a href="roles/haproxy/README.md">HA Proxy</a></a></li>
            <li><a href="#managed-etchostsroleshostsreadmemd"><a href="roles/hosts/README.md">Managed /etc/hosts</a></a></li>
            <li><a href="#jenkinsrolesjenkinsreadmemd"><a href="roles/jenkins/README.md">Jenkins</a></a></li>
            <li><a href="#meta-roles-that-group-individual-roles-togetherrolesmetareadmemd"><a href="roles/meta/README.md">&ldquo;Meta&rdquo; roles that group individual roles together.</a></a></li>
            <li><a href="#mariadb-clientrolesmysql_clientreadmemd"><a href="roles/mysql_client/README.md">MariaDB Client</a></a></li>
            <li><a href="#opcacherolesopcachereadmemd"><a href="roles/opcache/README.md">opcache</a></a></li>
            <li><a href="#defaults-file-for-ossecrolesossecreadmemd"><a href="roles/ossec/README.md">defaults file for ossec</a></a></li>
          </ul>
        </li>
        <li><a href="#license">License</a></li>
        <li><a href="#author-information">Author Information</a>
          <ul>
            <li><a href="#sshdrolesssh_serverreadmemd"><a href="roles/ssh_server/README.md">SSHD</a></a></li>
            <li><a href="#sslrolessslreadmemd"><a href="roles/ssl/README.md">SSL</a></a></li>
          </ul>
        </li>
        <li><a href="#contributecontributereadmemd"><a href="contribute/README.md">Contribute</a></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </aside><aside class="menu">
<p>Â </p>
<ul>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/">Home</a>
<ul>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/install">Install</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/scripts">Usage</a></li>
<li><a href="roles">Roles</a>
<ul>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ansible">Ansible</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/apt_extra_packages">Extra packages</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws">AWS tools roles</a>
<ul>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/ami_debian_buster">AMI Debian Buster</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_credentials">Amazon credentials</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_ec2_autoscale_cluster">Autoscale cluster</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_ec2_with_eip">AMI Debian Buster</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_efs_client">EFS client</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_provision_ec2_keypair">AWS key pair.</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_rds">AWS RDS</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_vpc">VPC</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_vpc_route">Update main route for a given VPC</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/aws/aws_vpc_subnet">VPC</a></li>
</ul>
</li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_deploy">ce-deploy</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_dev">Extra packages</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ce_provision">ce-provision</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/clamav_clamscan">ClamAV Clamscan</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/clamav_daemon">ClamAV Daemon</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/firewall">UFW Firewall</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/frontail">Frontail</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gitlab">Gitlab</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gitlab_runner">Gitlab Runner</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/gpg_key">GPG Key</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/haproxy">HA Proxy</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/hosts">Managed /etc/hosts</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/jenkins">Jenkins</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/_meta">&ldquo;Meta&rdquo; roles that group individual roles together.</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/mysql_client">MariaDB Client</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/nodejs">NodeJS</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/opcache">opcache</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ossec">defaults file for ossec</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/php_xdebug">PHP XDebug</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/rsyslog">Rsyslog</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ssh_server">SSHD</a></li>
<li><a href="https://codeenigma.github.io/ce-provision-docs/1.x/roles/ssl">SSL</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</aside>
    </body>
</html>
